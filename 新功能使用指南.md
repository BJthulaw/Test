# 法学研究科研绘图工具 v3.0 - 新功能使用指南

## 🚀 新增功能概览

### 1. 多格式模板导入支持
- **JSON模板**: 传统的结构化模板文件
- **图片模板**: 支持PNG、JPG、JPEG、GIF、BMP、TIFF格式的图片作为模板

### 2. 增强的显示和下载功能
- **页面内预览**: 生成结果直接在页面框架内显示
- **多格式下载**: 支持PNG、PDF、SVG、JPG格式下载
- **快速保存**: 自动保存到output目录

### 3. 优化的用户界面
- **分栏布局**: 左侧控制面板，右侧绘图预览区域
- **工具栏**: 快速操作按钮
- **状态栏**: 实时显示操作状态和进度
- **模板预览**: 可预览模板详细信息

## 📋 详细使用说明

### 导入图片模板

1. **准备图片模板**
   - 支持的格式：PNG、JPG、JPEG、GIF、BMP、TIFF
   - 建议尺寸：800x600像素或更大
   - 内容建议：包含图表结构、标题、示例元素

2. **导入步骤**
   - 点击"📁 导入模板"按钮
   - 在文件选择对话框中选择图片文件
   - 系统会自动识别图片格式并创建模板
   - 导入成功后会在模板列表中显示

3. **使用图片模板**
   - 从下拉列表选择导入的图片模板
   - 在文本输入框中输入相关内容
   - 点击"🎨 AI智能生成"或相关按钮生成图表

### 生成结果管理

1. **自动保存**
   - 每次生成图表后会自动保存到`output`目录
   - 文件名格式：`模板名称_时间戳.png`
   - 保存路径：`output/图表名称_20241201_143022.png`

2. **手动下载**
   - 点击"📥 下载结果"按钮
   - 选择保存位置和格式
   - 支持的下载格式：PNG、PDF、SVG、JPG

3. **快速保存**
   - 点击"💾 快速保存"按钮
   - 直接保存到output目录，无需选择路径

### 界面操作

1. **工具栏功能**
   - 🔄 刷新：重新加载模板和刷新界面
   - 💾 快速保存：快速保存当前图表
   - 📥 下载结果：下载生成的结果
   - 📊 预览模板：预览当前选择的模板

2. **控制面板**
   - **模板选择**: 选择要使用的模板
   - **文本输入**: 输入图表内容
   - **AI功能**: 启用/禁用AI分析
   - **操作面板**: 各种操作按钮

3. **绘图预览区域**
   - 实时显示生成的图表
   - 支持缩放、平移等操作
   - 包含matplotlib工具栏

## 🎯 使用示例

### 示例1：导入图片模板

```
1. 准备一张包含法律流程图结构的PNG图片
2. 点击"📁 导入模板"
3. 选择该PNG文件
4. 系统自动创建"法律流程图模板"
5. 在文本框中输入：
   法律问题分析
   相关法条查找
   判例研究
   法律适用分析
   结论形成
6. 点击"🎨 AI智能生成"
7. 查看生成的图表并下载
```

### 示例2：使用内置模板

```
1. 从模板列表选择"学术论文研究框架图"
2. 在文本框中输入研究内容
3. 启用AI分析功能
4. 点击"🎨 AI智能生成"
5. 系统自动分析并优化内容
6. 生成图表并自动保存
7. 使用"📥 下载结果"下载PDF格式
```

## 🔧 技术特性

### 图片模板处理
- **自动尺寸调整**: 根据画布大小自动调整图片显示尺寸
- **格式转换**: 支持多种图片格式的读取和显示
- **Base64编码**: 图片数据以Base64格式存储，便于传输和保存

### 文件管理
- **自动目录创建**: 自动创建output目录用于保存结果
- **时间戳命名**: 使用时间戳避免文件名冲突
- **多格式支持**: 支持多种图片和文档格式

### 用户体验优化
- **响应式布局**: 使用PanedWindow实现可调整的分栏布局
- **状态反馈**: 实时显示操作状态和进度信息
- **错误处理**: 完善的错误提示和处理机制

## 📁 文件结构

```
项目根目录/
├── main.py                    # 主程序文件
├── requirements.txt           # 依赖包列表
├── output/                    # 自动生成的输出目录
│   ├── 图表名称_20241201_143022.png
│   └── ...
├── sample_templates/          # 示例图片模板
│   ├── 法律流程图模板.png
│   ├── 学术研究框架模板.png
│   └── 决策树模板.png
├── templates/                 # JSON模板文件
│   ├── legal_templates.json
│   └── academic_templates.json
└── utils/                     # 工具模块
    ├── drawing_utils.py
    └── ai_service.py
```

## ⚠️ 注意事项

1. **图片格式要求**
   - 建议使用PNG格式以获得最佳质量
   - 图片尺寸建议不小于800x600像素
   - 避免使用过大的图片文件（建议小于10MB）

2. **保存路径**
   - 快速保存的文件会保存在`output`目录
   - 确保程序有写入权限
   - 下载功能可以选择任意位置

3. **AI功能**
   - 需要网络连接才能使用AI分析功能
   - AI服务可能偶尔出现超时，系统会自动降级到传统模式

4. **性能优化**
   - 大图片文件可能影响加载速度
   - 建议定期清理output目录中的旧文件

## 🆘 常见问题

**Q: 导入图片模板后无法显示？**
A: 检查图片格式是否支持，确保图片文件完整且未损坏。

**Q: 生成的图表在页面中显示不完整？**
A: 使用matplotlib工具栏的缩放功能调整显示，或调整窗口大小。

**Q: 下载功能无法使用？**
A: 确保先生成图表，然后使用下载功能。检查目标路径的写入权限。

**Q: AI功能无法使用？**
A: 检查网络连接，确认API密钥有效。可以禁用AI功能使用传统模式。

## 📞 技术支持

如遇到问题，请检查：
1. Python版本（建议3.8+）
2. 依赖包是否正确安装
3. 网络连接状态
4. 文件权限设置

---

*法学研究科研绘图工具 v3.0 - 让科研绘图更简单、更智能！* 